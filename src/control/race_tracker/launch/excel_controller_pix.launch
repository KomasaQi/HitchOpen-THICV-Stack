<launch>
    <!-- NMPC控制器管理器节点 -->
    <node pkg="race_tracker" 
          type="controller_manager" 
          name="controller_manager" 
          output="screen"
          respawn="true"> <!-- 崩溃后自动重启 -->

        <!-- 1. 核心参数配置 -->
        <param name="control_freq" type="double" value="20.0" /> <!-- 控制频率：25Hz -->
        <param name="topic/local_path" type="string" value="/race/local_path" />
        <param name="topic/vehicle_state" type="string" value="/race/vehicle_state" />
        <param name="topic/control" type="string" value="/race/control" />
        <param name="topic/flag" type="string" value="/race/flag" />
        <param name="ego_frame_id" type="string" value="ego_vehicle" />
        <param name="dual_steer_enable" type="bool" value="true" />
        <!-- 横向误差和航向误差开始降速的阈值 -->
        <param name="lateral_error_threshold" type="double" value="0.6" />
        <param name="heading_error_threshold" type="double" value="0.3" />
        <!-- 在各种绿色旗帜下因航向误差或横向误差而降低到的最小目标速度（km/h） -->
        <param name="default_min_target_speed" type="double" value="10.0" />
        <!-- 横向误差和航向误差超出阈值时，目标速度的降低比例 -->
        <param name="lateral_error_decrease_ratio" type="double" value="0.8" />
        <param name="heading_error_decrease_ratio" type="double" value="1.0" /> 
        

        <!-- 2. 仅使用NMPC插件 -->
        <rosparam param="plugins">
            - race_tracker::NMPCLateralController  <!-- NMPC双轴横向控制器 -->
            - race_tracker::PIDController  <!-- PID控制器 -->
        </rosparam>

        <!-- 3. 加载NMPC控制器参数 -->
        <rosparam command="load" file="$(find race_tracker)/config/excel_controller_pix.yaml" />

        <!-- <rosparam ns="nmpc_controller">
            <param name="front_steer_time_constant" value="0.01" /> 
            <param name="rear_steer_time_constant" value="0.01" /> 

        </rosparam> -->
    </node>

    <!-- 可选：启动rqt_graph查看节点关系 -->
    <!-- <node pkg="rqt_graph" type="rqt_graph" name="rqt_graph" output="screen" /> -->
</launch>
    